

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example “Currency” Contract Walkthrough (original) &mdash; Teos python 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="Teos python 1.0 documentation" href="index.html" />
    <link rel="next" title="Teos python" href="teos_python.html" />
    <link rel="prev" title="Example “Currency” Contract Walkthrough" href="currency_walkthrough.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="teos_python.html" title="Teos python"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="currency_walkthrough.html" title="Example “Currency” Contract Walkthrough"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Teos python 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Example &#8220;Currency&#8221; Contract Walkthrough (original)</a><ul>
<li><a class="reference internal" href="#example-smart-contracts">Example smart contracts</a></li>
<li><a class="reference internal" href="#setting-up-a-wallet-and-importing-account-key">Setting up a wallet and importing account key</a></li>
<li><a class="reference internal" href="#creating-accounts-for-sample-currency-contract">Creating accounts for sample &#8220;currency&#8221; contract</a></li>
<li><a class="reference internal" href="#upload-sample-currency-contract-to-blockchain">Upload sample &#8220;currency&#8221; contract to blockchain</a></li>
<li><a class="reference internal" href="#transfering-funds-with-the-sample-currency-contract">Transfering funds with the sample &#8220;currency&#8221; contract</a></li>
<li><a class="reference internal" href="#reading-sample-currency-contract-balance">Reading sample &#8220;currency&#8221; contract balance</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="currency_walkthrough.html"
                        title="previous chapter">Example &#8220;Currency&#8221; Contract Walkthrough</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="teos_python.html"
                        title="next chapter">Teos python</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/currency_walkthrough_org.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="example-currency-contract-walkthrough-original">
<span id="example-currency-contract-walkthrough-original"></span><h1><a class="reference external" href="#https://raw.githubusercontent.com/ekkis/eos/master/README.md">Example &#8220;Currency&#8221; Contract Walkthrough (original)</a><a class="headerlink" href="#example-currency-contract-walkthrough-original" title="Permalink to this headline">¶</a></h1>
<p>EOS comes with example contracts that can be uploaded and run for testing purposes. Next we demonstrate how to upload and interact with the sample contract &#8220;currency&#8221;.</p>
<p><a name="smartcontractexample"></a></p>
<div class="section" id="example-smart-contracts">
<span id="example-smart-contracts"></span><h2>Example smart contracts<a class="headerlink" href="#example-smart-contracts" title="Permalink to this headline">¶</a></h2>
<p>First, run the node</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> ~/eos/build/programs/nodeos/
./nodeos
</pre></div>
</div>
<p><a name="walletimport"></a></p>
</div>
<div class="section" id="setting-up-a-wallet-and-importing-account-key">
<span id="setting-up-a-wallet-and-importing-account-key"></span><h2>Setting up a wallet and importing account key<a class="headerlink" href="#setting-up-a-wallet-and-importing-account-key" title="Permalink to this headline">¶</a></h2>
<p>As you&#8217;ve previously added <code class="docutils literal"><span class="pre">plugin</span> <span class="pre">=</span> <span class="pre">eosio::wallet_api_plugin</span></code> into <code class="docutils literal"><span class="pre">config.ini</span></code>, EOS wallet will be running as a part of <code class="docutils literal"><span class="pre">nodeos</span></code> process. Every contract requires an associated account, so first, create a wallet.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> ~/eos/build/programs/cleos/
./cleos wallet create <span class="c1"># Outputs a password that you need to save to be able to lock/unlock the wallet</span>
</pre></div>
</div>
<p>For the purpose of this walkthrough, import the private key of the <code class="docutils literal"><span class="pre">eosio</span></code> account, a system account included within genesis.json, so that you&#8217;re able to issue API commands under authority of an existing account. The private key referenced below is found within your <code class="docutils literal"><span class="pre">config.ini</span></code> and is provided to you for testing purposes.</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos wallet import 5KQwrPbwdL6PhXujxW37FSSQZ1JiwsST4cqQzDeyXtP79zkvFD3
</pre></div>
</div>
<p><a name="createaccounts"></a></p>
</div>
<div class="section" id="creating-accounts-for-sample-currency-contract">
<span id="creating-accounts-for-sample-currency-contract"></span><h2>Creating accounts for sample &#8220;currency&#8221; contract<a class="headerlink" href="#creating-accounts-for-sample-currency-contract" title="Permalink to this headline">¶</a></h2>
<p>First, generate some public/private key pairs that will be later assigned as <code class="docutils literal"><span class="pre">owner_key</span></code> and <code class="docutils literal"><span class="pre">active_key</span></code>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">cd</span> ~/eos/build/programs/cleos/
./cleos create key <span class="c1"># owner_key</span>
./cleos create key <span class="c1"># active_key</span>
</pre></div>
</div>
<p>This will output two pairs of public and private keys</p>
<div class="highlight-python"><div class="highlight"><pre>Private key: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
Public key: EOSXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></div>
</div>
<p><strong>Important:</strong>
Save the values for future reference.</p>
<p>Run the <code class="docutils literal"><span class="pre">create</span></code> command where <code class="docutils literal"><span class="pre">eosio</span></code> is the account authorizing the creation of the <code class="docutils literal"><span class="pre">currency</span></code> account and <code class="docutils literal"><span class="pre">PUBLIC_KEY_1</span></code> and <code class="docutils literal"><span class="pre">PUBLIC_KEY_2</span></code> are the values generated by the <code class="docutils literal"><span class="pre">create</span> <span class="pre">key</span></code> command</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos create account eosio currency PUBLIC_KEY_1 PUBLIC_KEY_2
</pre></div>
</div>
<p>You should then get a JSON response back with a transaction ID confirming it was executed successfully.</p>
<p>Go ahead and check that the account was successfully created</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos get account currency
</pre></div>
</div>
<p>If all went well, you will receive output similar to the following:</p>
<div class="highlight-json"><div class="highlight"><pre>{
  &quot;account_name&quot;: &quot;currency&quot;,
  &quot;eos_balance&quot;: &quot;0.0000 EOS&quot;,
  &quot;staked_balance&quot;: &quot;0.0001 EOS&quot;,
  &quot;unstaking_balance&quot;: &quot;0.0000 EOS&quot;,
  &quot;last_unstaking_time&quot;: &quot;2035-10-29T06:32:22&quot;,
...
</pre></div>
</div>
<p>Now import the active private key generated previously in the wallet:</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos wallet import XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</pre></div>
</div>
<p><a name="uploadsmartcontract"></a></p>
</div>
<div class="section" id="upload-sample-currency-contract-to-blockchain">
<span id="upload-sample-currency-contract-to-blockchain"></span><h2>Upload sample &#8220;currency&#8221; contract to blockchain<a class="headerlink" href="#upload-sample-currency-contract-to-blockchain" title="Permalink to this headline">¶</a></h2>
<p>Before uploading a contract, verify that there is no current contract:</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos get code currency
code hash: 0000000000000000000000000000000000000000000000000000000000000000
</pre></div>
</div>
<p>With an account for a contract created, upload a sample contract:</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos <span class="nb">set</span> contract currency ../../contracts/currency/currency.wast ../../contracts/currency/currency.abi
</pre></div>
</div>
<p>As a response you should get a JSON with a <code class="docutils literal"><span class="pre">transaction_id</span></code> field. Your contract was successfully uploaded!</p>
<p>You can also verify that the code has been set with the following command:</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos get code currency
</pre></div>
</div>
<p>It will return something like:</p>
<div class="highlight-bash"><div class="highlight"><pre>code hash: 9b9db1a7940503a88535517049e64467a6e8f4e9e03af15e9968ec89dd794975
</pre></div>
</div>
<p>Before using the currency contract, you must issue the currency.</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos push action currency issue <span class="s1">&#39;{&quot;to&quot;:&quot;currency&quot;,&quot;quantity&quot;:&quot;1000.0000 CUR&quot;,&quot;memo&quot;:&quot;&quot;}&#39;</span> --permission currency@active
</pre></div>
</div>
<p>Next verify the currency contract has the proper initial balance:</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos get table currency currency account
<span class="o">{</span>
  <span class="s2">&quot;rows&quot;</span>: <span class="o">[{</span>
     <span class="s2">&quot;currency&quot;</span>: 1381319428,
     <span class="s2">&quot;balance&quot;</span>: 10000000
     <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">&quot;more&quot;</span>: <span class="nb">false</span>
<span class="o">}</span>
</pre></div>
</div>
<p><a name="pushamessage"></a></p>
</div>
<div class="section" id="transfering-funds-with-the-sample-currency-contract">
<span id="transfering-funds-with-the-sample-currency-contract"></span><h2>Transfering funds with the sample &#8220;currency&#8221; contract<a class="headerlink" href="#transfering-funds-with-the-sample-currency-contract" title="Permalink to this headline">¶</a></h2>
<p>Anyone can send any message to any contract at any time, but the contracts may reject messages which are not given necessary permission. Messages are not sent &#8220;from&#8221; anyone, they are sent &#8220;with permission of&#8221; one or more accounts and permission levels. The following commands show a &#8220;transfer&#8221; message being sent to the &#8220;currency&#8221; contract.</p>
<p>The content of the message is <code class="docutils literal"><span class="pre">'{&quot;from&quot;:&quot;currency&quot;,&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;20.0000</span> <span class="pre">CUR&quot;,&quot;memo&quot;:&quot;any</span> <span class="pre">string&quot;}'</span></code>. In this case we are asking the currency contract to transfer funds from itself to someone else. This requires the permission of the currency contract.</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos push action currency transfer <span class="s1">&#39;{&quot;from&quot;:&quot;currency&quot;,&quot;to&quot;:&quot;eosio&quot;,&quot;quantity&quot;:&quot;20.0000 CUR&quot;,&quot;memo&quot;:&quot;my first transfer&quot;}&#39;</span> --permission currency@active
</pre></div>
</div>
<p>Below is a generalization that shows the <code class="docutils literal"><span class="pre">currency</span></code> account is only referenced once, to specify which contract to deliver the <code class="docutils literal"><span class="pre">transfer</span></code> message to.</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos push action currency transfer <span class="s1">&#39;{&quot;from&quot;:&quot;${usera}&quot;,&quot;to&quot;:&quot;${userb}&quot;,&quot;quantity&quot;:&quot;20.0000 CUR&quot;,&quot;memo&quot;:&quot;&quot;}&#39;</span> --permission <span class="si">${</span><span class="nv">usera</span><span class="si">}</span>@active
</pre></div>
</div>
<p>As confirmation of a successfully submitted transaction, you will receive JSON output that includes a <code class="docutils literal"><span class="pre">transaction_id</span></code> field.</p>
<p><a name="readingcontract"></a></p>
</div>
<div class="section" id="reading-sample-currency-contract-balance">
<span id="reading-sample-currency-contract-balance"></span><h2>Reading sample &#8220;currency&#8221; contract balance<a class="headerlink" href="#reading-sample-currency-contract-balance" title="Permalink to this headline">¶</a></h2>
<p>So now check the state of both of the accounts involved in the previous transaction.</p>
<div class="highlight-bash"><div class="highlight"><pre>./cleos get table eosio currency account
<span class="o">{</span>
  <span class="s2">&quot;rows&quot;</span>: <span class="o">[{</span>
      <span class="s2">&quot;currency&quot;</span>: 1381319428,
      <span class="s2">&quot;balance&quot;</span>: 200000
       <span class="o">}</span>
    <span class="o">]</span>,
  <span class="s2">&quot;more&quot;</span>: <span class="nb">false</span>
<span class="o">}</span>
./cleos get table currency currency account
<span class="o">{</span>
  <span class="s2">&quot;rows&quot;</span>: <span class="o">[{</span>
      <span class="s2">&quot;currency&quot;</span>: 1381319428,
      <span class="s2">&quot;balance&quot;</span>: 9800000
    <span class="o">}</span>
  <span class="o">]</span>,
  <span class="s2">&quot;more&quot;</span>: <span class="nb">false</span>
<span class="o">}</span>
</pre></div>
</div>
<p>As expected, the receiving account <strong>eosio</strong> now has a balance of <strong>20</strong> tokens, and the sending account now has <strong>20</strong> less tokens than its initial supply.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="teos_python.html" title="Teos python"
             >next</a> |</li>
        <li class="right" >
          <a href="currency_walkthrough.html" title="Example “Currency” Contract Walkthrough"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Teos python 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2018, Tokenika.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>